# Platformer2D

Developed with Unreal Engine 5.4.1

# Сборка

* Чтобы запустить проект из исходников, необходимо наличие Unreal Engine 5.4 + Visual Studio. Запуск Platformer2D.uproject (Или запуск UE5 -> обзор -> Platformer2D.uproject)
* Важно: использовать 'git clone https://github.com/BethsFaith/Platformer2D.git', не скачивание zip-архива. 
* При появлении export-ошибок (после запуска .uproject): 
    1. Открыть вкладку "инструменты" -> "Открыть Visual Studio";
    2. В Visual Studio убедиться, что стоит сборка : Development Editor, Win64 + Unreal Build Tool. Нажать правой кнопкой мыши на "Решение" -> "Пересобрать решение";
    3. Перезапуcтить UE5;
    4. Если ошибки не исчезли: "Инструменты" -> "Обновить проект Visual Studio". Далее нажать кнопку компиляции с++ кода, дождаться её завершения и перезапустить UE5.  

# Запуск в редакторе

1. В UE5 нажать на зеленую кнопку "запустить этот уровень";
2. Для перехода к использованию клавиатуры может понадобиться щелкнуть левой кнопкой мыши внутри окна с игрой.

# Работа в редакторе

Доступны следующие изменения: 

* Максимальное количество здоровья, урон персонажей - MaxHP, Damage (категория "stats" или "показатели") в BP_MainCharacter, BP_Enemy;
* Секунды неуязвимости игрового персонажа после получения урона - IFrameSeconds в BP_MainCharacter;
* Анимации персонажей - переменные категории "Animations"("Анимации") в BP_MainCharacter, BP_PinkStar;
* Секунды после смерти врага до уничтожения его актора - SecondsBeforeDestroy в BP_Enemy, BP_PinkStar;
* Множитель скорости ходьбы врага при активации агрессивного режима (когда "увидел" игрока) - WalkingMltiplier; 
* Урон и отбрасывание игрока при контакте с ловушкой - Damage и RejectionAfterOverlapping в BP_Trap (или в классах-наследниках - если нужны разные значения для разных ловушек).

# Дополнительно

* Код в блюпринтах и на с++ содержит комментарии на русском языке. Если комментарии на с++ отображаются некорректно, убедитесь что включена кодировка Windows1251 (В VisualStudio по умолчанию).

* Ассеты, используемые в этом проекте: https://pixelfrog-assets.itch.io/treasure-hunters

* .exe файл (dev сборка) : https://drive.google.com/file/d/1niVBgnHSVIBXVZmMmOaT2UFTN7q4enRP/view?usp=drive_link
Запуск: Platformer2/Binaries/Win64/Platformer2.exe

# Управление

* x - атака;
* a - передвижение влево;
* d - передвижение вправо;
* spacebar - прыжок.

# Игра 

* В игре присутствует вражеское нпс, которое при приближении игрока включает агр режим (ускоряется и движется по направлению к игроку);
* Шипы наносят урон игровому персонажу при контакте. Морская раковина срабатывает как ловушка, имеет перезарядку (3 сек);
* Черепа и зелья являются собираемыми предметами, счетчик по первым отображается слева в верхем углу, а зелья - пополняют здоровье, которое так же отображается в левом верхнем углу экрана;
* При приближении к сундуку (или после смерти игрового персонажа) открывается ui с возможностью перезапуска уровня.

# Решение

1. Персонажи:

* ABasePaperCharacter - наследник от APaperCharacter, содержит показатели здоровья, урона, работу с анимациями (переходы), является базовым классом для персонажа игрока и врагов;
* AMainCharacter - содержит камеру и сбор предметов;
* AEnemyCharacter - содержит функционал реагирования нпс на приближение/отдаление игрового персонажа;

* BP_Enemy - класс, написанный на блюпринтах, содержит основую логику вражеского нпс. Предполагается как основа (родитель) для всех врагов. Например, для создания нового врага (Как BP_PinkStar) достаточно наследоваться от этого класса и заполнить переменные в категории "анимации" и "показатели";
* BP_MainCharacter - класс на блюпринтах, содержит основной функционал для игрового персонажа;

* AIC_Enemy - контроллер, содержит базовое поведение (движение) для вражеских нпс.

2. Предметы: 

* BP_Item - базовый класс, содержит box с коллизией, который при столкновении с игроком вызывает определенный event;
* BP_Heal - предмет для восстановления хп игрока:
* BP_Treasure - предмет для коллекционирования.

3. UI:

* BP_UserUi - отображение здоровья и количества предметов у игрока (внутри используются классы BP_UserHPBar и BP_TreasureCounter):
* BP_GameOver - для перезапуска игры. Срабатывает после смерти персонажа игрока или когда уровень "пройден".

4. Ловушки/Препятствия

* BP_Trap - базовый класс, содержит функцию OverlapWithPlayer и переменные, от которых зависит урон игроку и вектор его отбрасывания от ловушки;
* BP_Spikes - шипы, урон игроку при контакте, отбрасывает игрока назад по координате Z; 
* BP_SeaShell - ловушка с перезарядкой, отбрасывает игрока назад по координате X;

Примечание: отбрасывание после получения урона сделано для того, чтобы игрок не стоял на ловушках + имел возможность приземлиться в другое место.

Подробности реализации в комментариях к blueprint-схемам или с++. 
